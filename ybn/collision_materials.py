import bpy
from ..sollumz_properties import MaterialType
from collections import namedtuple

CollisionMaterial = namedtuple("CollisionMaterial", "ui_name, color")

collisionmats = {
    "DEFAULT" : CollisionMaterial("Default", (255, 0, 255, 255)),
    "CONCRETE" : CollisionMaterial("Concrete", (145, 145, 145, 255)),
    "CONCRETE_PAVEMENT" : CollisionMaterial("Concrete Pavement", (145, 145, 145, 255)),
    "TARMAC" : CollisionMaterial("Tarmac", (90, 90, 90, 255)),
    "ROCK" : CollisionMaterial("Rock", (185, 185, 185, 255)),
    "ROCK_MOSSY" : CollisionMaterial("Rock Mossy", (185, 185, 185, 255)),
    "STONE" : CollisionMaterial("Stone", (185, 185, 185, 255)),
    "COBBLESTONE" : CollisionMaterial("Cobblestone", (185, 185, 185, 255)),
    "COBBLESTONE_DIRT" : CollisionMaterial("Cobblestone Dirt", (185, 255, 185, 255)),
    "BRICK" : CollisionMaterial("Brick", (195, 95, 30, 255)),
    "BRICK_PAVEMENT" : CollisionMaterial("Brick Pavement", (195, 95, 30, 255)),
    "MARBLE" : CollisionMaterial("Marble", (195, 155, 145, 255)),
    "SANDSTONE_SOLID" : CollisionMaterial("Sandstone Solid", (215, 195, 150, 255)),
    "SANDSTONE_BRITTLE" : CollisionMaterial("Sandstone Brittle", (205, 180, 120, 255)),
    "SAND_COMPACT" : CollisionMaterial("Sand Compact", (250, 240, 220, 255)),
    "SAND_WET" : CollisionMaterial("Sand Wet", (190, 185, 165, 255)),
    "SAND_DRY_DEEP" : CollisionMaterial("Sand Dry Deep", (110, 100, 85, 255)),
    "SAND_WET_DEEP" : CollisionMaterial("Sand Wet Deep", (110, 100, 85, 255)),
    "QUICKSAND" : CollisionMaterial("Quicksand", (214, 178, 34, 255)),
    "ALGAE" : CollisionMaterial("Algae", (8, 122, 4, 255)),
    "ALGAE_THICK" : CollisionMaterial("Algae Thick", (4, 69, 1, 255)),
    "TAR_PIT" : CollisionMaterial("Tar Pit", (0, 0, 0, 255)),
    "ICE" : CollisionMaterial("Ice", (200, 250, 255, 255)),
    "SNOW_COMPACT" : CollisionMaterial("Snow Compact", (255, 255, 255, 255)),
    "SNOW_DEEP" : CollisionMaterial("Snow Deep", (255, 255, 255, 255)),
    "SLUSH" : CollisionMaterial("Slush", (38, 16, 5, 255)),
    "GRAVEL_SMALL" : CollisionMaterial("Gravel Small", (87, 87, 87, 255)),
    "GRAVEL_LARGE" : CollisionMaterial("Gravel Large", (87, 87, 87, 255)),
    "GRAVEL_WET" : CollisionMaterial("Gravel Wet", (51, 51, 51, 255)),
    "GRAVEL_DEEP" : CollisionMaterial("Gravel Deep", (51, 51, 51, 255)),
    "GRAVEL_MUDDY" : CollisionMaterial("Gravel Muddy", (59, 46, 46, 255)),
    "GRAVEL_MUDDY_DEEP" : CollisionMaterial("Gravel Muddy Deep", (59, 46, 46, 255)),
    "GRAVEL_DIRT" : CollisionMaterial("Gravel Dirt", (66, 54, 46, 255)),
    "GRAVEL_GRASS" : CollisionMaterial("Gravel Grass", (49, 74, 54, 255)),
    "DIRT_TRACK" : CollisionMaterial("Dirt Track", (175, 160, 140, 255)),
    "DIRT_TRACK_DEEP" : CollisionMaterial("Dirt Track Deep", (176, 152, 120, 255)),
    "DIRT_GRASS" : CollisionMaterial("Dirt Grass", (88, 105, 56, 255)),
    "MUD_HARD" : CollisionMaterial("Mud Hard", (175, 160, 140, 255)),
    "MUD_POTHOLE" : CollisionMaterial("Mud Pothole", (105, 95, 75, 255)),
    "MUD_SOFT" : CollisionMaterial("Mud Soft", (105, 95, 75, 255)),
    "MUD_UNDERWATER" : CollisionMaterial("Mud Underwater", (75, 65, 50, 255)),
    "MUD_DEEP" : CollisionMaterial("Mud Deep", (105, 95, 75, 255)),
    "MARSH" : CollisionMaterial("Marsh", (105, 95, 75, 255)),
    "MARSH_DEEP" : CollisionMaterial("Marsh Deep", (82, 74, 58, 255)),
    "SOIL" : CollisionMaterial("Soil", (51, 46, 37, 255)),
    "SOIL_DEEP" : CollisionMaterial("Soil Deep", (41, 37, 29, 255)),
    "CLAY_HARD" : CollisionMaterial("Clay Hard", (160, 160, 1601, 255)),
    "CLAY_SOFT" : CollisionMaterial("Clay Soft", (160, 160, 160, 255)),
    "ASH" : CollisionMaterial("Ash", (74, 71, 70, 255)),
    "COAL" : CollisionMaterial("Coal", (13, 160, 174, 255)),
    "MANURE" : CollisionMaterial("Manure", (107, 126, 148, 255)),
    "MOSS" : CollisionMaterial("Moss", (95, 131, 109, 255)),
    "MOSS_DEEP" : CollisionMaterial("Moss Deep", (42, 124, 180, 255)),
    "GRASS_DEAD" : CollisionMaterial("Grass Dead", (193, 18, 255, 255)),
    "GRASS_LUSH" : CollisionMaterial("Grass Lush", (23, 160, 113, 255)),
    "GRASS_LONG" : CollisionMaterial("Grass Long", (183, 92, 0, 255)),
    "GRASS" : CollisionMaterial("Grass", (148, 51, 98, 255)),
    "GRASS_SHORT" : CollisionMaterial("Grass Short", (13, 245, 144, 255)),
    "HAY" : CollisionMaterial("Hay", (140, 218, 127, 255)),
    "BUSHES" : CollisionMaterial("Bushes", (181, 239, 188, 255)),
    "SPARSE_BUSHES" : CollisionMaterial("Sparse Bushes", (57, 16, 195, 255)),
    "DENSE_BUSHES" : CollisionMaterial("Dense Bushes", (156, 195, 226, 255)),
    "TWIGS" : CollisionMaterial("Twigs", (7, 251, 7, 255)),
    "PINE_NEEDLES" : CollisionMaterial("Pine Needles", (38, 120, 85, 255)),
    "LEAVES_DRY" : CollisionMaterial("Leaves Dry", (108, 248, 11, 255)),
    "LEAVES_TOBACCO" : CollisionMaterial("Leaves Tobacco", (160, 239, 14, 255)),
    "LEAVES" : CollisionMaterial("Leaves", (65, 22, 188, 255)),
    "LEAVES_MAPLE" : CollisionMaterial("Leaves Maple", (156, 133, 231, 255)),
    "LEAVES_OAK" : CollisionMaterial("Leaves Oak", (79, 205, 139, 255)),
    "LEAVES_FICUS" : CollisionMaterial("Leaves Ficus", (24, 208, 227, 255)),
    "WOODCHIPS" : CollisionMaterial("Woodchips", (79, 129, 56, 255)),
    "TREE_PINE" : CollisionMaterial("Tree Pine", (193, 227, 231, 255)),
    "TREE_PINE_SNOW" : CollisionMaterial("Tree Pine Snow", (154, 224, 92, 255)),
    "FLOWERS" : CollisionMaterial("Flowers", (136, 146, 194, 255)),
    "CROP_HUSK" : CollisionMaterial("Crop Husk", (67, 110, 17, 255)),
    "TREE_BARK" : CollisionMaterial("Tree Bark", (21, 18, 2, 255)),
    "CACTUS" : CollisionMaterial("Cactus", (47, 53, 41, 255)),
    "METAL_SOLID_SMALL" : CollisionMaterial("Metal Solid Small", (91, 191, 22, 255)),
    "METAL_SOLID_MEDIUM" : CollisionMaterial("Metal Solid Medium", (221, 98, 223, 255)),
    "METAL_SOLID_LARGE" : CollisionMaterial("Metal Solid Large", (116, 118, 6, 255)),
    "METAL_HOLLOW_SMALL" : CollisionMaterial("Metal Hollow Small", (83, 21, 207, 255)),
    "METAL_HOLLOW_MEDIUM" : CollisionMaterial("Metal Hollow Medium", (82, 50, 0, 255)),
    "METAL_HOLLOW_LARGE" : CollisionMaterial("Metal Hollow Large", (145, 9, 49, 255)),
    "METAL_CHAINLINK_SMALL" : CollisionMaterial("Metal Chainlink Small", (101, 19, 249, 255)),
    "METAL_CORRUGATED_IRON" : CollisionMaterial("Metal Corrugated Iron", (68, 147, 221, 255)),
    "METAL_GRILLE" : CollisionMaterial("Metal Grille", (68, 132, 43, 255)),
    "METAL_RAILING" : CollisionMaterial("Metal Railing", (50, 23, 172, 255)),
    "METAL_RAILING_TRAM" : CollisionMaterial("Metal Railing Tram", (20, 74, 36, 255)),
    "METAL_DUCT" : CollisionMaterial("Metal Duct", (51, 143, 92, 255)),
    "METAL_PENETRABLE" : CollisionMaterial("Metal Penetrable", (37, 13, 73, 255)),
    "METAL_BARS" : CollisionMaterial("Metal Bars", (133, 14, 130, 255)),
    "WOOD_ROOF" : CollisionMaterial("Wood Roof", (172, 112, 6, 255)),
    "WOOD_BURNING" : CollisionMaterial("Wood Burning", (190, 54, 236, 255)),
    "WOOD_BURNT" : CollisionMaterial("Wood Burnt", (42, 177, 254, 255)),
    "WOOD_CHIPS" : CollisionMaterial("Wood Chips", (145, 184, 155, 255)),
    "WOOD_SOLID_SMALL" : CollisionMaterial("Wood Solid Small", (200, 123, 232, 255)),
    "WOOD_SOLID_MEDIUM" : CollisionMaterial("Wood Solid Medium", (146, 187, 171, 255)),
    "WOOD_SOLID_LARGE" : CollisionMaterial("Wood Solid Large", (6, 0, 84, 255)),
    "WOOD_SOLID_POLISHED" : CollisionMaterial("Wood Solid Polished", (36, 162, 183, 255)),
    "WOOD_FLOOR_DUSTY" : CollisionMaterial("Wood Floor Dusty", (24, 211, 214, 255)),
    "WOOD_HOLLOW_SMALL" : CollisionMaterial("Wood Hollow Small", (213, 132, 112, 255)),
    "WOOD_HOLLOW_MEDIUM" : CollisionMaterial("Wood Hollow Medium", (25, 244, 246, 255)),
    "WOOD_HOLLOW_LARGE" : CollisionMaterial("Wood Hollow Large", (96, 165, 207, 255)),
    "WOOD_OLD_CREAKY" : CollisionMaterial("Wood Old Creaky", (201, 202, 231, 255)),
    "WOOD_LATTICE" : CollisionMaterial("Wood Lattice", (156, 159, 188, 255)),
    "WOOD_PENETRABLE" : CollisionMaterial("Wood Penetrable", (64, 124, 248, 255)),
    "CERAMIC" : CollisionMaterial("Ceramic", (101, 241, 220, 255)),
    "ROOF_TILE" : CollisionMaterial("Roof Tile", (238, 140, 125, 255)),
    "TARPAULIN" : CollisionMaterial("Tarpaulin", (149, 135, 211, 255)),
    "PLASTIC_CLEAR" : CollisionMaterial("Plastic Clear", (142, 103, 228, 255)),
    "PLASTIC_HOLLOW_CLEAR" : CollisionMaterial("Plastic Hollow Clear", (9, 188, 8, 255)),
    "PLASTIC_HIGH_DENSITY_CLEAR" : CollisionMaterial("Plastic High Density Clear", (19, 132, 158, 255)),
    "RUBBER" : CollisionMaterial("Rubber", (5, 212, 152, 255)),
    "CARPET_SOLID" : CollisionMaterial("Carpet Solid", (2, 26, 146, 255)),
    "CARPET_SOLID_DUSTY" : CollisionMaterial("Carpet Solid Dusty", (77, 250, 20, 255)),
    "CLOTH" : CollisionMaterial("Cloth", (76, 249, 81, 255)),
    "CLOTH_SACK" : CollisionMaterial("Cloth Sack", (117, 73, 51, 255)),
    "PLASTER_SOLID" : CollisionMaterial("Plaster Solid", (99, 168, 150, 255)),
    "PLASTER_BRITTLE" : CollisionMaterial("Plaster Brittle", (251, 191, 68, 255)),
    "PLASTER_PENETRABLE" : CollisionMaterial("Plaster Penetrable", (42, 57, 245, 255)),
    "PAPER" : CollisionMaterial("Paper", (46, 169, 102, 255)),
    "FEATHER_PILLOW" : CollisionMaterial("Feather Pillow", (116, 157, 127, 255)),
    "LEATHER" : CollisionMaterial("Leather", (117, 201, 61, 255)),
    "SLATTED_BLINDS" : CollisionMaterial("Slatted Blinds", (170, 35, 99, 255)),
    "UPHOLSTRY" : CollisionMaterial("Upholstry", (174, 172, 152, 255)),
    "CURTAINS" : CollisionMaterial("Curtains", (180, 248, 124, 255)),
    "WICKER" : CollisionMaterial("Wicker", (140, 15, 221, 255)),
    "TERRACOTTA" : CollisionMaterial("Terracotta", (224, 148, 83, 255)),
    "PORCELAIN" : CollisionMaterial("Porcelain", (130, 18, 100, 255)),
    "TILE" : CollisionMaterial("Tile", (70, 243, 178, 255)),
    "GRAIN_SACK" : CollisionMaterial("Grain Sack", (22, 18, 252, 255)),
    "SAND_BAG" : CollisionMaterial("Sand Bag", (179, 166, 214, 255)),
    "PAINT_CAN" : CollisionMaterial("Paint Can", (3, 84, 9, 255)),
    "TRASH" : CollisionMaterial("Trash", (25, 90, 67, 255)),
    "GLASS_SHOOT_THROUGH" : CollisionMaterial("Glass Shoot Through", (66, 23, 55, 255)),
    "GLASS_BOTTLE_SHOT" : CollisionMaterial("Glass Bottle Shot", (105, 198, 17, 255)),
    "GLASS_BOTTLE_MEDICINE" : CollisionMaterial("Glass Bottle Medicine", (47, 94, 211, 255)),
    "GLASS_BOTTLE_LIQUOR" : CollisionMaterial("Glass Bottle Liquor", (106, 28, 53, 255)),
    "GLASS_BOTTLE_JUG" : CollisionMaterial("Glass Bottle Jug", (196, 203, 13, 255)),
    "GLASS_BULLETPROOF" : CollisionMaterial("Glass Bulletproof", (208, 71, 49, 255)),
    "GLASS_BULLETPROOF_SEE_THROUGH" : CollisionMaterial("Glass Bulletproof See Through", (194, 190, 108, 255)),
    "GLASS_OPAQUE" : CollisionMaterial("Glass Opaque", (34, 247, 219, 255)),
    "CAR_METAL" : CollisionMaterial("Car Metal", (103, 148, 63, 255)),
    "CAR_SOFTTOP" : CollisionMaterial("Car Softtop", (118, 223, 135, 255)),
    "CAR_SOFTTOP_CLEAR" : CollisionMaterial("Car Softtop Clear", (80, 214, 82, 255)),
    "CAR_GLASS_WEAK" : CollisionMaterial("Car Glass Weak", (224, 253, 42, 255)),
    "CAR_GLASS_MEDIUM" : CollisionMaterial("Car Glass Medium", (59, 67, 186, 255)),
    "CAR_GLASS_STRONG" : CollisionMaterial("Car Glass Strong", (33, 10, 169, 255)),
    "CAR_GLASS_BULLETPROOF" : CollisionMaterial("Car Glass Bulletproof", (248, 135, 99, 255)),
    "CAR_GLASS_OPAQUE" : CollisionMaterial("Car Glass Opaque", (241, 182, 185, 255)),
    "CAR_ENGINE" : CollisionMaterial("Car Engine", (10, 237, 111, 255)),
    "VEH_WOOD" : CollisionMaterial("Veh Wood", (54, 122, 179, 255)),
    "WEAPON_WOOD" : CollisionMaterial("Weapon Wood", (7, 152, 109, 255)),
    "WEAPON_METAL" : CollisionMaterial("Weapon Metal", (50, 83, 87, 255)),
    "WATER_SHALLOW" : CollisionMaterial("Water Shallow", (79, 89, 133, 255)),
    "WATER" : CollisionMaterial("Water", (118, 150, 221, 255)),
    "BLOOD" : CollisionMaterial("Blood", (248, 88, 29, 255)),
    "OIL" : CollisionMaterial("Oil", (120, 21, 121, 255)),
    "PETROL" : CollisionMaterial("Petrol", (121, 98, 56, 255)),
    "PUDDLE" : CollisionMaterial("Puddle", (254, 116, 13, 255)),
    "PUDDLE_ANKLE" : CollisionMaterial("Puddle Ankle", (128, 21, 35, 255)),
    "WATER_ANKLE" : CollisionMaterial("Water Ankle", (198, 174, 22, 255)),
    "WATER_SHIN" : CollisionMaterial("Water Shin", (252, 229, 150, 255)),
    "WATER_KNEE" : CollisionMaterial("Water Knee", (28, 15, 77, 255)),
    "FRESH_MEAT" : CollisionMaterial("Fresh Meat", (64, 188, 20, 255)),
    "DRIED_MEAT" : CollisionMaterial("Dried Meat", (160, 97, 161, 255)),
    "FURRY_MEAT" : CollisionMaterial("Furry Meat", (187, 212, 186, 255)),
    "PELT_FUR" : CollisionMaterial("Pelt Fur", (249, 18, 189, 255)),
    "LEATHER_HIDE" : CollisionMaterial("Leather Hide", (89, 219, 236, 255)),
    "BONES" : CollisionMaterial("Bones", (227, 149, 18, 255)),
    "EMISSIVE_GLASS" : CollisionMaterial("Emissive Glass", (252, 65, 201, 255)),
    "EMISSIVE_PLASTIC" : CollisionMaterial("Emissive Plastic", (200, 154, 233, 255)),
    "VFX_METAL_ELECTRIFIED" : CollisionMaterial("Vfx Metal Electrified", (171, 206, 224, 255)),
    "VFX_METAL_WATER_TOWER" : CollisionMaterial("Vfx Metal Water Tower", (208, 217, 131, 255)),
    "VFX_WOOD_BEER_BARREL" : CollisionMaterial("Vfx Wood Beer Barrel", (186, 214, 67, 255)),
    "VFX_METAL_STEAM" : CollisionMaterial("Vfx Metal Steam", (214, 28, 60, 255)),
    "VFX_METAL_FLAME" : CollisionMaterial("Vfx Metal Flame", (79, 170, 77, 255)),
    "PHYS_NO_FRICTION" : CollisionMaterial("Phys No Friction", (145, 105, 140, 255)),
    "PHYS_CASTER" : CollisionMaterial("Phys Caster", (86, 40, 171, 255)),
    "PHYS_CAR_VOID" : CollisionMaterial("Phys Car Void", (235, 96, 219, 255)),
    "PHYS_PED_CAPSULE" : CollisionMaterial("Phys Ped Capsule", (242, 129, 201, 255)),
    "PHYS_MACHINERY" : CollisionMaterial("Phys Machinery", (150, 129, 14, 255)),
    "PHYS_BARBED_WIRE" : CollisionMaterial("Phys Barbed Wire", (31, 24, 20, 255)),
    "PHYS_BLOCKER" : CollisionMaterial("Phys Blocker", (232, 56, 231, 255)),
    "PHYS_DYNAMIC_COVER_BOUND" : CollisionMaterial("Phys Dynamic Cover Bound", (61, 118, 195, 255)),
    "BUTTOCKS" : CollisionMaterial("Buttocks", (49, 37, 215, 255)),
    "THIGH_LEFT" : CollisionMaterial("Thigh Left", (43, 236, 32, 255)),
    "SHIN_LEFT" : CollisionMaterial("Shin Left", (142, 80, 193, 255)),
    "FOOT_LEFT" : CollisionMaterial("Foot Left", (104, 95, 50, 255)),
    "THIGH_RIGHT" : CollisionMaterial("Thigh Right", (231, 65, 32, 255)),
    "SHIN_RIGHT" : CollisionMaterial("Shin Right", (220, 135, 140, 255)),
    "FOOT_RIGHT" : CollisionMaterial("Foot Right", (154, 171, 233, 255)),
    "SPINE0" : CollisionMaterial("Spine0", (193, 200, 37, 255)),
    "SPINE1" : CollisionMaterial("Spine1", (125, 244, 3, 255)),
    "SPINE2" : CollisionMaterial("Spine2", (218, 1, 178, 255)),
    "SPINE3" : CollisionMaterial("Spine3", (56, 44, 225, 255)),
    "CLAVICLE_LEFT" : CollisionMaterial("Clavicle Left", (49, 187, 40, 255)),
    "UPPER_ARM_LEFT" : CollisionMaterial("Upper Arm Left", (152, 136, 6, 255)),
    "LOWER_ARM_LEFT" : CollisionMaterial("Lower Arm Left", (157, 233, 14, 255)),
    "HAND_LEFT" : CollisionMaterial("Hand Left", (199, 54, 216, 255)),
    "CLAVICLE_RIGHT" : CollisionMaterial("Clavicle Right", (42, 230, 228, 255)),
    "UPPER_ARM_RIGHT" : CollisionMaterial("Upper Arm Right", (68, 5, 114, 255)),
    "LOWER_ARM_RIGHT" : CollisionMaterial("Lower Arm Right", (153, 10, 170, 255)),
    "HAND_RIGHT" : CollisionMaterial("Hand Right", (226, 49, 194, 255)),
    "NECK" : CollisionMaterial("Neck", (197, 101, 103, 255)),
    "HEAD" : CollisionMaterial("Head", (81, 63, 83, 255)),
    "ANIMAL_DEFAULT" : CollisionMaterial("Animal Default", (113, 110, 30, 255)),
    "PROP_ROCK" : CollisionMaterial("Prop Rock", (103, 79, 193, 255)),
    "PROP_STONE" : CollisionMaterial("Prop Stone", (176, 174, 204, 255)),
    "TAR_PAPER" : CollisionMaterial("Tar Paper", (60, 33, 222, 255)),
    "AM_BASE_WOOD_RAILROAD" : CollisionMaterial("Am Base Wood Railroad", (254, 245, 167, 255)),
    "WOOD_RAILROAD" : CollisionMaterial("Wood Railroad", (8, 127, 90, 255)),
    "BONE_LIGHT" : CollisionMaterial("Bone Light", (241, 43, 75, 255)),
    "BONE_HEAVY" : CollisionMaterial("Bone Heavy", (52, 25, 24, 255)),
    "WOOD_ROTTEN" : CollisionMaterial("Wood Rotten", (12, 147, 178, 255)),
}

def create_collision_material_from_index(collision_name: str):

    matinfo = collisionmats[collision_name]

    mat = bpy.data.materials.new(collision_name)
    mat.sollum_type = MaterialType.COLLISION
    mat.collision_properties.collision_index = collision_name
    mat.use_nodes = True
    r = matinfo.color[0] / 255
    g = matinfo.color[1] / 255
    b = matinfo.color[2] / 255
    mat.node_tree.nodes["Principled BSDF"].inputs[0].default_value = (
        r, g, b, 1)

    return mat
